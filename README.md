# Serverless Workshop

This repo will teach you the [core concepts of serverless](https://github.com/DavidWells/serverless-workshop/tree/master/lessons-code-complete/core-concepts) and walk through a variety of ready to deploy [serverless architectures](https://github.com/DavidWells/serverless-workshop/tree/master/lessons-code-complete/events)

If you'd like the serverless training for your team, [get in touch with me](https://davidwells.io/contact/).

## Table of Contents

<!-- AUTO-GENERATED-CONTENT:START (TOC) -->
- [Using this repo](#using-this-repo)
- [Workshop Lessons](#workshop-lessons)
  * [Core Concepts](#core-concepts)
  * [Events](#events)
- [Helpful Tools](#helpful-tools)
- [Prerequisites & Setup Steps](#prerequisites--setup-steps)
- [Troubleshooting & FAQ](#troubleshooting--faq)
<!-- AUTO-GENERATED-CONTENT:END -->

## Using this repo

After following the [prerequisite setup steps](https://github.com/DavidWells/serverless-workshop#prerequisites--setup-steps), work from the [**lessons**](./lessons) folders.

If you get stuck or want to look ahead checkout the [**lessons-code-complete**](./lessons-code-complete) directory for the completed code.

Repo directory structure:

- **/lessons** - âœ… work from these files!
- **/lessons-code-complete** - ðŸ’¡Complete lesson answers
- **/_instructor** - ðŸ™ˆ ignore these, unless updating lessons

## Workshop Lessons

<!-- AUTO-GENERATED-CONTENT:START (GENERATE_LESSONS_LIST)-->
### Core Concepts

| Lesson | Final Code  |
|:--------------------------- |:-----|
| [1 Http Hello World](https://github.com/DavidWells/serverless-workshop/tree/master/lessons/core-concepts/1-http-hello-world) <br/> Deploying Your First Endpoint | [Complete Code](https://github.com/DavidWells/serverless-workshop/tree/master/lessons-code-complete/core-concepts/1-http-hello-world)  |
| [2 Http Dynamic Content](https://github.com/DavidWells/serverless-workshop/tree/master/lessons/core-concepts/2-http-dynamic-content) <br/> Dynamic Content in Functions | [Complete Code](https://github.com/DavidWells/serverless-workshop/tree/master/lessons-code-complete/core-concepts/2-http-dynamic-content)  |
| [3 Http Post With Cors](https://github.com/DavidWells/serverless-workshop/tree/master/lessons/core-concepts/3-http-post-with-cors) <br/> Deploying an http POST endpoint with CORS support | [Complete Code](https://github.com/DavidWells/serverless-workshop/tree/master/lessons-code-complete/core-concepts/3-http-post-with-cors)  |
| [4 Using Env Vars](https://github.com/DavidWells/serverless-workshop/tree/master/lessons/core-concepts/4-using-env-vars) <br/> Using environment variables | [Complete Code](https://github.com/DavidWells/serverless-workshop/tree/master/lessons-code-complete/core-concepts/4-using-env-vars)  |
| [5 Using Serverless Variable Syntax](https://github.com/DavidWells/serverless-workshop/tree/master/lessons/core-concepts/5-using-serverless-variable-syntax) <br/> Using Serverless variable syntax | [Complete Code](https://github.com/DavidWells/serverless-workshop/tree/master/lessons-code-complete/core-concepts/5-using-serverless-variable-syntax)  |
| [6 Using Addition Resources](https://github.com/DavidWells/serverless-workshop/tree/master/lessons/core-concepts/6-using-addition-resources) <br/> Defining additional resources | [Complete Code](https://github.com/DavidWells/serverless-workshop/tree/master/lessons-code-complete/core-concepts/6-using-addition-resources)  |
| [7 Using Serverless Plugins](https://github.com/DavidWells/serverless-workshop/tree/master/lessons/core-concepts/7-using-serverless-plugins) <br/> Extending Serverless Functionality with plugins | [Complete Code](https://github.com/DavidWells/serverless-workshop/tree/master/lessons-code-complete/core-concepts/7-using-serverless-plugins)  |
| [8 Using Multiple Stages](https://github.com/DavidWells/serverless-workshop/tree/master/lessons/core-concepts/8-using-multiple-stages) <br/> Deploying to Multiple Stages | [Complete Code](https://github.com/DavidWells/serverless-workshop/tree/master/lessons-code-complete/core-concepts/8-using-multiple-stages)  |


### Events

| Lesson | Final Code  |
|:--------------------------- |:-----|
| [Dynamodb Streams](https://github.com/DavidWells/serverless-workshop/tree/master/lessons/events/dynamodb-streams) <br/> Using DynamoDB streams | [Complete Code](https://github.com/DavidWells/serverless-workshop/tree/master/lessons-code-complete/events/dynamodb-streams)  |
| [Kinesis Basic](https://github.com/DavidWells/serverless-workshop/tree/master/lessons/kinesis/kinesis-basic) <br/> Simple Kinesis Example | [Complete Code](https://github.com/DavidWells/serverless-workshop/tree/master/lessons-code-complete/kinesis/kinesis-basic)  |
| [Kinesis](https://github.com/DavidWells/serverless-workshop/tree/master/lessons/events/kinesis) <br/> Using Kinesis as an Event Source | [Complete Code](https://github.com/DavidWells/serverless-workshop/tree/master/lessons-code-complete/events/kinesis)  |
| [S3](https://github.com/DavidWells/serverless-workshop/tree/master/lessons/events/s3) <br/> Triggering Lambda functions from s3 events | [Complete Code](https://github.com/DavidWells/serverless-workshop/tree/master/lessons-code-complete/events/s3)  |
| [Schedule](https://github.com/DavidWells/serverless-workshop/tree/master/lessons/events/schedule) <br/> Triggering functions via cron schedules | [Complete Code](https://github.com/DavidWells/serverless-workshop/tree/master/lessons-code-complete/events/schedule)  |
| [Sns](https://github.com/DavidWells/serverless-workshop/tree/master/lessons/events/sns) <br/> Using AWS SNS as event source | [Complete Code](https://github.com/DavidWells/serverless-workshop/tree/master/lessons-code-complete/events/sns)  |
| [Sns Advanced](https://github.com/DavidWells/serverless-workshop/tree/master/lessons/sns/sns-advanced) <br/> Using External SNS Topics Example | [Complete Code](https://github.com/DavidWells/serverless-workshop/tree/master/lessons-code-complete/sns/sns-advanced)  |
| [Sns Basic](https://github.com/DavidWells/serverless-workshop/tree/master/lessons/sns/sns-basic) <br/> Basic SNS Example | [Complete Code](https://github.com/DavidWells/serverless-workshop/tree/master/lessons-code-complete/sns/sns-basic)  |
| [Step Functions](https://github.com/DavidWells/serverless-workshop/tree/master/lessons/events/step-functions) <br/> Using AWS Step Functions | [Complete Code](https://github.com/DavidWells/serverless-workshop/tree/master/lessons-code-complete/events/step-functions)  |


<!-- AUTO-GENERATED-CONTENT:END -->

## Helpful Tools

- [PostMan](https://www.getpostman.com/) - desktop app for quick & easy endpoint testing
- [NVM](https://github.com/creationix/nvm) - Node version manager
- [yaml validator](http://yaml-online-parser.appspot.com/)
- [yaml linter & validator](https://jsonformatter.org/yaml-validator)

## Prerequisites & Setup Steps

1. **Install the latest LTS version of [Node](https://nodejs.org/)**. [How to install Node](https://docs.npmjs.com/getting-started/installing-node).
2. **Verify you have [git](https://git-scm.com/downloads) on your machine**

    Most machines come pre-loaded with git. ðŸŽ‰

    To verify you have `git`, open up your terminal and run:

    ```bash
    which git
    ```

    This should return a path of where git is installed. If the command returns `git not found`, we will need to install git on your machine.

3. **Setup a AWS account**.Â 

    If you don't already have an AWS account, let's get one setup.

    [Click here to setup a free AWS account](https://aws.amazon.com/free/)

    It's recommended to not use pre-existing AWS account running production code.

    Make sure you add valid billing information and verify your account.

4. **[Install serverless CLI](https://serverless.com/framework/docs/getting-started/)**

    Open up your terminal and run:

    ```bash
    npm install serverless -g
    ```

5. **Connect the serverless CLI with your AWS account credentials**.Â 

    [See the docs](https://serverless.com/framework/docs/providers/aws/guide/credentials/)Â orÂ [watch the video](https://www.youtube.com/watch?v=KngM5bfpttA)

6. **Verify the Serverless CLI works on your machine**

    Open up your terminal and run:

    ```
    serverless --help
    ```

    This should return the list of commands from the CLI tool.

    Now let's verify your AWS account is correctly configured. Open up your terminal and run the following commands:

    ```bash
    # create a test project
    serverless create --template aws-nodejs --path my-test-service
    # move into the `my-test-service` directory
    cd my-test-service
    # deploy the test service to verify AWS credentials
    serverless deploy
    ```

    This should deploy the test service into AWS. If you encounter errors, please ping me and we can get them sorted out.

**Bonus setup:**

- If you have an IDE/editor with YAML linting it will be helpful. (like this [atom plugin](https://atom.io/packages/linter-js-yaml), or [vs code plugin](https://marketplace.visualstudio.com/items?itemName=djabraham.vscode-yaml-validation))
- Install [postman](https://www.getpostman.com/) for quick & easy testing of endpoints we deploy
- It's also recommended that you use [nvm](https://github.com/creationix/nvm) (node version manager) just in case you need to change versions of node for the workshop.

## Troubleshooting & FAQ

- `I don't see my [insert AWS service XYZ] in the AWS console`

    This happens to the best of us. Make sure you are in the correct region in the AWS console. You can get the current region of your service by typing `sls info` into the terminal.

- `serverless deploy` hangs

    This typically happens when aws credentials are misconfigured. Double check your `~/.aws/credentials` file and make sure the values are correct.

- `Y A M L Exception`

    check your `yaml` indentation syntax. [yaml validator](http://yaml-online-parser.appspot.com/) | [yaml validator two](https://jsonformatter.org/yaml-validator)

- `Unable to import module 'handler': Error at Function.Module._resolveFilename (module.js:469:15)`

    This error means lambda can't find your included `node_modules`. Make sure you `npm install` in your project and install all your dependancies locally before running `sls deploy`

- `Unable to delete bucket` error.

    Your s3 bucket in question might have files in it. You will need to head into AWS cloudformation in the console and manually delete the bucket and cloudformation stack.

- `Stack [xyz] cannot be deleted while in status UPDATE_ROLLBACK_COMPLETE_CLEANUP_IN_PROGRESS`

    This happens when cloudformation gets stuck in a weird state. You might need to log into the AWS console, head into cloudformation and delete the stack from the UI
